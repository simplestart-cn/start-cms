(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e6e36f0"],{"3f15":function(e,t,n){"use strict";n("7564")},7564:function(e,t,n){},"9ed6":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container",style:{backgroundImage:e.backgroundImage}},[e.backgroundImage?e._e():n("div",{staticClass:"bubbles"},e._l(e.backgroundBubbles,(function(e,t){return n("svg",{key:t,attrs:{version:"1.1",id:"StartCMS",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"128px",height:"128px",viewBox:"0 0 128 128","enable-background":"new 0 0 128 128","xml:space":"preserve"}},[n("path",{attrs:{fill:"#71C0E9","fill-opacity":"0.35",d:"M97.658,48.586c0.109,0.193,0.169,0.412,0.169,0.635v33.655c0,0.915-0.489,1.761-1.284,2.216l-29.363,16.84\n\tc-0.611,0.352-1.393,0.139-1.744-0.473c-0.109-0.193-0.168-0.412-0.168-0.636V67.169c0-0.915,0.489-1.761,1.283-2.216l29.363-16.84\n\tC96.525,47.763,97.307,47.974,97.658,48.586L97.658,48.586z"}}),n("path",{attrs:{fill:"#71C0E9","fill-opacity":"0.35",d:"M30.932,47.944c0.223,0,0.442,0.058,0.635,0.169l29.364,16.84c0.794,0.455,1.283,1.301,1.283,2.216v33.654\n\tc0,0.706-0.571,1.276-1.277,1.276c-0.223,0-0.442-0.059-0.635-0.168L30.939,85.091c-0.794-0.455-1.284-1.301-1.284-2.216V49.221\n\tC29.655,48.516,30.227,47.944,30.932,47.944L30.932,47.944z"}}),n("path",{attrs:{fill:"#71C0E9","fill-opacity":"0.35",d:"M65.646,26.805l28.717,16.469c0.611,0.351,0.822,1.131,0.473,1.743c-0.113,0.197-0.275,0.36-0.473,0.472\n\tL65.646,61.958c-1.182,0.677-2.631,0.677-3.813,0L33.119,45.489c-0.612-0.351-0.823-1.131-0.472-1.743\n\tc0.113-0.197,0.276-0.36,0.472-0.472l28.717-16.468C63.016,26.128,64.466,26.128,65.646,26.805L65.646,26.805z"}}),n("path",{attrs:{fill:"#BFBFBF","fill-opacity":"0.35",d:"M63.866,7.875c2.973,0,5.407,2.3,5.618,5.216l35.623,20.543c0.838-0.468,1.783-0.713,2.742-0.711\n\tc3.111,0,5.633,2.519,5.633,5.625c0,2.206-1.271,4.115-3.121,5.037v40.569c1.994,0.865,3.39,2.851,3.39,5.16\n\tc0,3.107-2.521,5.627-5.633,5.627c-1.334,0.002-2.627-0.473-3.644-1.338L69.455,113.8c0.027,0.229,0.043,0.464,0.043,0.699\n\tc0,3.106-2.521,5.626-5.632,5.626s-5.632-2.52-5.632-5.626c0-0.263,0.018-0.522,0.053-0.776L23.833,93.855\n\tc-1.003,0.924-2.345,1.487-3.817,1.487c-3.11,0-5.632-2.518-5.632-5.625c0-2.209,1.274-4.12,3.129-5.041v-41.29\n\tc-1.927-0.894-3.263-2.844-3.263-5.105c0-3.107,2.521-5.626,5.632-5.626c1.12,0,2.163,0.327,3.041,0.89l35.32-20.369\n\tC58.411,10.221,60.864,7.875,63.866,7.875z M68.823,16.174c-0.952,1.758-2.815,2.953-4.958,2.953c-2.116,0-3.96-1.167-4.922-2.891\n\tl-33.988,19.6c0.369,0.763,0.56,1.599,0.559,2.446c0,2.894-2.188,5.277-5.001,5.591v40.242c2.878,0.251,5.135,2.664,5.135,5.604\n\tc0,0.551-0.08,1.084-0.228,1.588l34.071,19.648c1.033-1.27,2.608-2.082,4.374-2.082c1.792,0,3.388,0.836,4.419,2.139l34.495-19.893\n\tc-0.195-0.581-0.295-1.189-0.295-1.803c0-2.852,2.123-5.207,4.875-5.576V44.155c-2.881-0.248-5.144-2.663-5.144-5.605\n\tc-0.001-0.95,0.239-1.884,0.698-2.716L68.823,16.174L68.823,16.174z"}})])})),0),n("el-form",{ref:"loginForm",staticClass:"login-form shadow",attrs:{rules:e.loginRules,model:e.loginForm,autocomplete:"on","label-position":"left",size:"medium"}},[e.core.title?n("h3",{staticClass:"title"},[e._v(e._s(e.core.title))]):n("h3",{staticClass:"title",staticStyle:{height:"30px"}}),n("el-tabs",{model:{value:e.formType,callback:function(t){e.formType=t},expression:"formType"}},[n("el-tab-pane",{attrs:{label:"密码登录",name:"login"}},[n("el-form-item",{attrs:{prop:"account"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"user"}})],1),n("el-input",{ref:"account",attrs:{placeholder:"账户名/手机号",name:"account",type:"text",tabindex:"1",autocomplete:"on"},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}})],1),n("el-form-item",{attrs:{prop:"password"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"password"}})],1),n("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"登录密码",name:"password",tabindex:"2",autocomplete:"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),n("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[n("svg-icon",{attrs:{"icon-class":"password"===e.passwordType?"eye":"eye-open"}})],1)],1),n("el-form-item",{attrs:{prop:"code"}},[n("span",{staticClass:"svg-container"},[n("svg-icon",{attrs:{"icon-class":"lock"}})],1),n("el-input",{ref:"captcha",attrs:{placeholder:"验证码",name:"code",tabindex:"3",autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),n("span",{staticClass:"change-code",on:{click:e.handleImage}},[n("input",{attrs:{type:"hidden",name:"uniqid"},domProps:{value:e.captcha.uniqid}}),n("img",{attrs:{src:e.captcha.image}})])],1),n("el-button",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{loading:e.btnLoading,type:"primary",size:"medium"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("登录")])],1),n("el-tab-pane",{attrs:{name:"register",label:"手机登陆",disabled:!e.core.open_register}},[n("el-form-item",{attrs:{prop:"mobile"}},[n("span",{staticClass:"svg-container"},[n("i",{staticClass:"el-icon-mobile-phone"})]),n("el-input",{ref:"mobile",attrs:{placeholder:"手机号码",name:"mobile",type:"text",size:"medium",tabindex:"1",autocomplete:"on"},model:{value:e.loginForm.mobile,callback:function(t){e.$set(e.loginForm,"mobile",t)},expression:"loginForm.mobile"}})],1),n("el-form-item",{attrs:{prop:"code"}},[n("span",{staticClass:"svg-container"},[n("i",{staticClass:"el-icon-message"})]),n("el-input",{ref:"captcha",attrs:{placeholder:"验证码",name:"code",size:"medium",tabindex:"2",autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),n("span",{staticClass:"change-code",on:{click:e.handleCode}},[n("el-button",{attrs:{disabled:e.btnDisabled,type:"text"}},[e._v(e._s(e.btnText))])],1)],1),n("div",{staticClass:"tips text-right text-df"},[n("span",[e._v("未注册手机号验证后自动注册")])]),n("div",{staticClass:"social-login flex align-center justify-center"}),n("el-button",{staticStyle:{width:"100%","margin-top":"30px"},attrs:{loading:e.btnLoading,type:"primary",size:"medium"},nativeOn:{click:function(t){return t.preventDefault(),e.handleRegister(t)}}},[e._v("注册/登录")])],1)],1)],1),e._m(0)],1)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"copyright"},[e._v("Powered by "),n("a",{attrs:{href:"http://www.startcms.cn",target:"_blank"}},[e._v("start-cms")])])}],r=(n("ac6a"),n("456d"),n("b775"));function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/core/config/info",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/core/captcha/image",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/core/captcha/mobile",method:"post",data:e})}var l={name:"Login",components:{},data:function(){var e=this,t=function(t,n,o){"register"!==e.formType||n?o():o(new Error("手机号不能为空"))},n=function(t,n,o){"login"!==e.formType||n?o():o(new Error("账户不能为空"))},o=function(t,n,o){"login"!==e.formType||n?o():o(new Error("密码不能为空"))},a=function(e,t,n){t?n():n(new Error("验证码不能为空"))};return{core:{logo:"",title:"",open_register:!1},formType:"login",loginForm:{mobile:"",account:"",password:"",code:""},loginRules:{mobile:[{required:!0,trigger:"blur",validator:t}],account:[{required:!0,trigger:"blur",validator:n}],password:[{required:!0,trigger:"blur",validator:o}],code:[{required:!0,trigger:"blur",validator:a}]},captcha:{image:"",uniqid:""},btnText:"获取短信验证码",btnLoading:!1,btnDisabled:!1,backgroundImage:"",backgroundBubbles:new Array(10),passwordType:"password",redirect:void 0,otherQuery:{}}},computed:{},watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},created:function(){var e=this;i({app:"core"}).then((function(t){e.core=t.data,e.core.background_image&&(e.backgroundImage="url("+e.core.background_image+")")})),this.handleImage()},mounted:function(){""===this.loginForm.account?this.$refs.account.focus():""===this.loginForm.password&&this.$refs.password.focus()},methods:{showPwd:function(){var e=this;"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleImage:function(){var e=this;c().then((function(t){e.captcha=t.data,e.loginForm.code=""}))},handleCode:function(){var e=this;if(this.btnDisabled)return!1;var t=this.loginForm.mobile;this.btnDisabled=!0,s({mobile:t}).then((function(t){if(!t.code)var n=60,o=setInterval((function(){e.btnText="重新获取("+n+")",n--,0===n&&(e.btnText="获取短信验证码",e.btnDisabled=!1,clearInterval(o))}),1e3)})).catch((function(t){e.btnDisabled=!1}))},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;Object.assign(e.loginForm,e.captcha),e.btnLoading=!0,e.$store.dispatch("user/login",e.loginForm).then((function(t){e.btnLoading=!1,t.code?e.$message.error(t.msg):e.$router.push({path:e.redirect||"/",query:e.otherQuery})})).catch((function(t){e.btnLoading=!1,e.handleImage()}))}))},handleRegister:function(){var e=this;this.$refs.loginForm.validate((function(t){if(!t)return!1;e.btnLoading=!0,e.$store.dispatch("user/register",e.loginForm).then((function(t){e.btnLoading=!1,t.code?e.$message.error(t.msg):e.$router.push({path:e.redirect||"/",query:e.otherQuery})})).catch((function(t){e.btnLoading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,n){return"redirect"!==n&&(t[n]=e[n]),t}),{})}}},d=l,u=(n("3f15"),n("2877")),p=Object(u["a"])(d,o,a,!1,null,"63e99982",null);t["default"]=p.exports}}]);